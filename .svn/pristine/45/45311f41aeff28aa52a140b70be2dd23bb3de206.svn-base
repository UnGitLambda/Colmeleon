# -*- coding: utf-8 -*-
import tkinter as tk
from PIL import ImageTk
from FrameDnD import FrameDnD
import sys
sys.path.insert(0, "../Image")
from Image import Image
from Parser import Parser
while "../Image" in sys.path:
    sys.path.remove("../Image")

class CanvasDnD(FrameDnD, tk.Canvas):
    def load_image(self, event):
        self.image = self.load_image_file((str(event.data).replace("{", "").replace("}", "")));

    
    def load_image_file(self, Sfile):
        self.image = Image.Image(Sfile)
        img = Parser.scale_image(self.image)
        self.tkImg = ImageTk.PhotoImage(img)
        self.config(height = self.tkImg.height(), width = self.tkImg.width())
        self.create_image(self.tkImg.width(), self.tkImg.height(), image = self.tkImg, anchor = tk.SE)
    
    def load_image_selection(self):
        """
        This method is the one used by the button open (for the files) on the GUI.
        It opens a window allowing the user to browse its file and then reads and load the selected file.
        """
        typeslist = [("IMG file", ".img"), ("JPG file", ".jpg"), ("PNG file", ".png"), ("PDF file", ".pdf"), ("*", ".*")]
        Sfile = tk.filedialog.askopenfilename(title = "SÃ©lectionnez un fichier ..." , filetypes = typeslist)
        self.load_image_file(Sfile)