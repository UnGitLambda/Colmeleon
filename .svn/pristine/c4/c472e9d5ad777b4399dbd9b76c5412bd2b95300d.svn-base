import unittest
from Histogram import ColorHistogram, GreyHistogram, Histogram
import numpy as np
from skimage.io import imread

black_square = np.zeros((10,10,3))
red_array = np.array([(150,0,0) for x in range(0,100)])
red_square = np.reshape(red_array,(10,10,3))

class TestHistogram(unittest.TestCase):


    def setUp(self):
        pass

    def test_init(self):
        histo1 = Histogram(black_square)
        self.assertIsInstance(histo1.histograms,GreyHistogram)
        self.assertNotIsInstance(histo1.histograms,ColorHistogram)

    def test_init2(self):
        histo1 = Histogram(red_square)
        self.assertNotIsInstance(histo1.histograms,GreyHistogram)
        self.assertIsInstance(histo1.histograms,ColorHistogram)

class TestColorHistogram(unittest.TestCase):


    def test_init(self):
        pass

    def test_histograms_lenght(self):
        histo1 = Histogram(red_square)
        self.assertEqual(len(histo1.histograms.get_red()), histo1.bins)
        self.assertEqual(len(histo1.histograms.get_green()), histo1.bins)
        self.assertEqual(len(histo1.histograms.get_blue()), histo1.bins)

    def test_red_square(self):
        """DOESN'T work unknown reason"""
        image = imread("red_square.png") #file not found but here 
        histo1 = Histogram(image)

        expected_red = [0 for i in range(256)]
        expected_red[255] = 10000
        print(expected_red)
        print(histo1.histograms.get_red())
        self.assertListEqual(list(histo1.histograms.redHistogram[0]),expected_red)

        """DOESN'T work"""
        #histo1 = Histogram(red_square)
        #expected_blue_green = [0 for i in range(256)]
        #expected_blue_green[0] = 100
        #
        #self.assertListEqual(list(histo1.histograms.get_blue()),expected_blue_green)
        #self.assertListEqual(list(histo1.histograms.get_green()),expected_blue_green)

        #Red histograms from get_red() doesn't seem to work correctly
        #expected_red = [0 for i in range(256)]
        #expected_red[254] = 100
        #print(expected_red)
        #print(histo1.histograms.get_red())
        #self.assertListEqual(list(histo1.histograms.redHistogram[0]),expected_red)
        pass



class TestGreyHistogram(unittest.TestCase):

    def test_init(self):
        pass

    def test_get_grey(self):
        """DOESN'T work"""
        histo1 = Histogram(black_square)
        expected_result = [0 for i in range(256)]
        expected_result[0] = 100
        self.assertListEqual(list(histo1.histograms.get_grey()),expected_result)


        #histo2 = Histogram(255 - black_square)
        #print(255- black_square)
        #expected_result = [0 for i in range(256)]
        #expected_result[255] = 100
        #self.assertListEqual(list(histo2.histograms.get_grey()),expected_result)
        pass



if __name__ == '__main__':
    unittest.main()